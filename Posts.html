<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Posts</title>
  <link rel="stylesheet" href="CSS/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <link href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link rel="stylesheet" href="CSS/toastr.min.css">
<style>
/*Light Mode*/
body.light-mode {
  background-color: #ffffff !important;
  color: #000000 !important;
}
body.light-mode table {
  background-color: #ffffff !important;
  color: #000000 !important;
}
body.light-mode .table thead {
  background-color: #e9ecef !important;
  color: #000000 !important;
}

/* Dark Mode */
body.dark-mode {
  background-color: #121212 !important;
  color: #ffffff !important;
}
body.dark-mode table {
  background-color: #1e1e1e !important;
  color: #ffffff !important;
}
body.dark-mode .table thead {
  background-color: #343a40 !important;
  color: #ffffff !important;
}

/* Navbar styling */
.navbar.light-mode {
  background-color: #f8f9fa !important;
  color: #000 !important;
}
.navbar.light-mode .navbar-brand,
.navbar.light-mode .nav-link {
  color: #000 !important;
}

.navbar.dark-mode {
  background-color: #212529 !important;
  color: #fff !important;
}
.navbar.dark-mode .navbar-brand,
.navbar.dark-mode .nav-link {
  color: #fff !important;
}

/* Bigger dark/light switch */
.form-check-input {
  width: 3rem;
  height: 1.6rem;
  cursor: pointer;
}
#sunIcon, #moonIcon {
  font-size: 1.1rem;
  margin-left: 8px;
  transition: opacity .2s ease;
}
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <button class="navbar-toggler " type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="#">Control Panel</a>
    <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="index.html">Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="users.html">Users</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" aria-disabled="true" href="Posts.html">Posts</a>
        </li>
      </ul>
      <div class="form-check form-switch d-flex align-items-center">
        <input class="form-check-input" type="checkbox" id="darkModeSwitch">
        <label class="form-check-label ms-2" for="darkModeSwitch">
          <i class="fa-solid fa-sun text-warning" id="sunIcon"></i>
          <i class="fa-solid fa-moon text-light d-none" id="moonIcon"></i>
        </label>
      </div>
    </div>
  </div>
</nav>

<nav class="navbar navbar-expand-lg">
  <div class="container-fluid">
    <a class="navbar-brand ms-5" href="#">Manage Posts</a>
    <div class="collapse navbar-collapse justify-content-end">
      <button class="btn btn-outline-info me-5" type="button" data-bs-toggle="modal" data-bs-target="#postModal">
        Add Post <i class="fa-solid fa-pen-to-square ms-2"></i>
      </button>
    </div>
  </div>
</nav>

<!-- Table -->
<table class="table" id="myTable">
  <thead class="table-warning">
    <tr>
      <th>ID</th>
      <th>User ID</th>
      <th>Title</th>
      <th>Body</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody class="table-group-divider"></tbody>
</table>

<!-- Modal -->
<div class="modal fade" id="postModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-info text-white">
        <h5 class="modal-title">Add / Edit Post</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="postForm">
          <input type="hidden" id="postId">
          <div class="mb-3">
            <label for="userId" class="form-label">User ID</label>
            <input type="number" class="form-control" id="userId" required>
          </div>
          <div class="mb-3">
            <label for="title" class="form-label">Title</label>
            <input type="text" class="form-control" id="title" required>
          </div>
          <div class="mb-3">
            <label for="body" class="form-label">Body</label>
            <textarea class="form-control" id="body" rows="3" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Save Post</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="Js/bootstrap.bundle.min.js"></script>
<script src="Js/posts.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
<script src="Js/toastr.min.js"></script>

<script>
// DataTables
$(document).ready(function () {
  let table = $('#myTable').DataTable({
    paging: true,
    searching: true,
    ordering: true,
    info: true,
    lengthMenu: [5, 10, 25, 50,100],
    language: {
      search: "searchðŸ”Ž :",
      lengthMenu: "show _MENU_ records",
      info: "show _START_ to _END_ out of _TOTAL_",
      paginate: { next: "next", previous: "previous" }
    }
  });

  fetch("https://jsonplaceholder.typicode.com/posts")
    .then(res => res.json())
    .then(data => {
      data.forEach(post => {
        table.row.add([
          post.userId,
          post.id,
          post.title,
          post.body,
          `<button class="edit bg-info rounded border border-1">
             <i class="fa-solid fa-user-pen text-white"></i>
           </button>
           <button class="delete ms-2 bg-danger rounded border border-1">
             <i class="fa-solid fa-trash text-white"></i>
           </button>`
        ]).draw();
      }).catch(err => { console.error(err); toastr.error('Failed to load Posts'); });
    });
});
</script>

<script>
(function () {
  const switchBtn = document.getElementById("darkModeSwitch");
  const sunIcon = document.getElementById("sunIcon");
  const moonIcon = document.getElementById("moonIcon");
  const navbars = document.querySelectorAll('.navbar');

  function applyDark() {
    document.body.classList.remove('light-mode');
    document.body.classList.add('dark-mode');
    sunIcon.classList.add('d-none');
    moonIcon.classList.remove('d-none');
    navbars.forEach(n => {
      n.classList.remove('light-mode');
      n.classList.add('dark-mode');
    });
  }

  function applyLight() {
    document.body.classList.remove('dark-mode');
    document.body.classList.add('light-mode');
    moonIcon.classList.add('d-none');
    sunIcon.classList.remove('d-none');
    navbars.forEach(n => {
      n.classList.remove('dark-mode');
      n.classList.add('light-mode');
    });
  }

  const saved = localStorage.getItem('theme') || 'light';
  if (saved === 'dark') { applyDark(); switchBtn.checked = true; } 
  else { applyLight(); switchBtn.checked = false; }

  switchBtn.addEventListener('change', () => {
    if (switchBtn.checked) { applyDark(); localStorage.setItem('theme','dark'); }
    else { applyLight(); localStorage.setItem('theme','light'); }
  });
})();
</script>
</body>
</html>
